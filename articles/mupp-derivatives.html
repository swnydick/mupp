<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GGUM and MUPP Derivatives • mupp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GGUM and MUPP Derivatives">
<meta property="og:description" content="mupp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mupp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mupp-derivatives.html">GGUM and MUPP Derivatives</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/swnydick/mupp/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mupp-derivatives_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GGUM and MUPP Derivatives</h1>
                        <h4 class="author">Steven W. Nydick</h4>
            
            <h4 class="date">2021-07-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/swnydick/mupp/blob/master/vignettes/mupp-derivatives.Rmd"><code>vignettes/mupp-derivatives.Rmd</code></a></small>
      <div class="hidden name"><code>mupp-derivatives.Rmd</code></div>

    </div>

    
    
<p>This vignette is designed to provide the equations used in the <code>mupp</code> package and derive some of the first and second derivatives necessary for estimating item and person parameters.</p>
<div id="the-ggum-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-ggum-model" class="anchor"></a>The GGUM Model</h2>
<div id="model-properties" class="section level3">
<h3 class="hasAnchor">
<a href="#model-properties" class="anchor"></a>Model Properties</h3>
<p>The generalized graded unfolding model (GGUM) is an ideal point item response theory (IRT) model (de la Torre, Stark, &amp; Chernyshenko, 2006). Unlike many IRT models for achievement tests that assume higher ability results in a higher likelihood of endorsing an item, ideal point models assume that a person is most likely to endorse an item only if they have a particular trait level <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Trait levels higher or lower than the item location are assumed equally likely to endorse the item. We can compare the two-parameter IRT model (2PL) with the GGUM in the following display.</p>
<p><img src="mupp-derivatives_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Note that in both models, the “location” parameter (<span class="math inline">\(b\)</span> in the 2PL and <span class="math inline">\(\delta\)</span> in the GGUM model) is set to 0. However, the meaning of location differ between models. For the 2PL, location refers to the inflection point of the IRT function (i.e., the point at which the slope is at its maximum). However, with respect to the GGUM model, the location refers not to the point at which the change in probability is at a maximum but, instead, the point at which the probability itself is greatest.</p>
<p>The standard two-choice GGUM model takes the following form:</p>
<p><span class="math display">\[
P_{\text{ggum}} = P(X = 1 \, | \, \theta, \alpha, \delta, \tau)
                = \frac{\exp(\alpha[ (\theta - \delta) - \tau]) +
                        \exp(\alpha[2(\theta - \delta) - \tau)])}
                       {1 +
                        \exp(\alpha[ (\theta - \delta) - \tau])  +
                        \exp(\alpha[2(\theta - \delta) - \tau)]) +
                        \exp(\alpha[3(\theta - \delta)])}
\]</span></p>
<p>with <span class="math inline">\(\alpha\)</span> designating the slope of the model (relating to the steepness of the curve as <span class="math inline">\(\theta \to \delta\)</span>), <span class="math inline">\(\delta\)</span> indicating the ideal point of the model, and <span class="math inline">\(\tau\)</span> representing the overall assent probability across all <span class="math inline">\(\theta\)</span>. One can think of the GGUM model as an ocean, with <span class="math inline">\(\alpha\)</span> the height of the wave, <span class="math inline">\(\delta\)</span> the location of the wave, and <span class="math inline">\(\tau\)</span> the overall depth of the ocean. The following pictures indicate how changes to <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\delta\)</span>, and <span class="math inline">\(\tau\)</span> affect the item response function.</p>
<p><img src="mupp-derivatives_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;"></p>
<p><img src="mupp-derivatives_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<p><img src="mupp-derivatives_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>As can easily be seen in the above plots, changing <span class="math inline">\(\alpha\)</span> changes the peakedness of the hump, changing <span class="math inline">\(\delta\)</span> changes the location of the hump, and changing <span class="math inline">\(\tau\)</span> changes the overall height of the entire distribution.</p>
</div>
<div id="model-derivatives" class="section level3">
<h3 class="hasAnchor">
<a href="#model-derivatives" class="anchor"></a>Model Derivatives</h3>
<p>To determine the derivative of the GGUM (with respect to <span class="math inline">\(\theta\)</span>), define the following expressions:</p>
<p><span class="math display">\[
\begin{align}
x   &amp;= \exp(\alpha[ (\theta - \delta) - \tau])\\
y   &amp;= \exp(\alpha[2(\theta - \delta) - \tau)])\\
z   &amp;= \exp(\alpha[3(\theta - \delta)])
\end{align}
\]</span></p>
<p>Due to properties of the exponential function, the individual derivatives are as follows:</p>
<p><span class="math display">\[
\begin{align}
\frac{dx}{d\theta}  &amp;= 1\alpha\times x\\
\frac{dy}{d\theta}  &amp;= 2\alpha\times y\\
\frac{dz}{d\theta}  &amp;= 3\alpha\times z
\end{align}
\]</span></p>
<p>Using the division rule, the derivative of <span class="math inline">\(P_{\text{ggum}}\)</span> with respect to <span class="math inline">\(\theta\)</span> is as follows:</p>
<p><span class="math display">\[
\begin{align}
\frac{dP_{\text{ggum}}}{d\theta} &amp;= \frac{d\left(\frac{(x + y)}{(1 + x + y + z)}\right)}{d\theta}\\
                                 &amp;= \frac{(1 + x + y + z)\left(\frac{d(x + y)}{d\theta}\right) - (x + y)\left(\frac{d(1 + x + y + z)}{d\theta}\right)}{(1 + x + y + z)^2}\\
                                 &amp;= \frac{(1 + x + y + z)(\alpha(x + 2y)) - (x + y)(\alpha(x + 2y + 3z))}{(1 + x + y + z)^2}\\
                                 &amp;= \frac{(1 + z)(\alpha(x + 2y)) - (x + y)(\alpha(3z))}{(1 + x + y + z)^2}\\
                                 &amp;= \frac{\alpha(x + zx + 2y + 2zy - 3xz - 3yz)}{(1 + x + y + z)^2}\\
                                 &amp;= \frac{\alpha[x(1 - 2z) + y(2 - z)]}{(1 + x + y + z)^2}
\end{align}
\]</span></p>
<p>with <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> defined above.</p>
<p>The second derivative does not simplify as well, but one can still come up with a general form. First define the following relations:</p>
<p><span class="math display">\[
\begin{align}
N   &amp;= \alpha[x(1 - 2z) + y(2 - z)]\\
R   &amp;= (1 + x + y + z)^2
\end{align}
\]</span></p>
<p>Then using the properties above, it can easily be shown that</p>
<p><span class="math display">\[
\begin{align}
\frac{dN}{d\theta}  &amp;= \alpha[x(-6\alpha z) + (1 - 2z)(\alpha x) + y(-3\alpha z) + (2 - z)(2\alpha y)]\\
                    &amp;= \alpha^2[-6xz + x - 2xz - 3yz + 4y - 2yz]\\
                    &amp;= \alpha^2[x - 8xz + 4y - 5yz]\\
                    &amp;= \alpha^2[x(1 - 8z) + y(4 - 5z)]\\
\frac{dR}{d\theta}  &amp;= 2\alpha(1 + x + y + z)(x + 2y + 3z)
\end{align}
\]</span></p>
<p>And the second derivative can be constructed as follows:</p>
<p><span class="math display">\[
\frac{d^2P_{\text{ggum}}}{d\theta^2} = \frac{R\left(\frac{dN}{d\theta}\right) - N\left(\frac{dR}{d\theta}\right)}{R^2}
\]</span></p>
<p>with the above equations plugged in. This is not a particularly simple functional form, but the analytic version of the second derivative does not seem to simplify to a more computationally efficient form.</p>
</div>
</div>
<div id="the-mupp-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-mupp-model" class="anchor"></a>The MUPP Model</h2>
<div id="model-properties-1" class="section level3">
<h3 class="hasAnchor">
<a href="#model-properties-1" class="anchor"></a>Model Properties</h3>
<p>Given two (or more) probability statements, one can rank them in terms of how they apply to any particular person. The multi-unidimensional pairwise preference model (MUPP; Stark, Chernyshenko, &amp; Drasgow, 2005) was developed to model the likelihood of choosing one statement over another. These statements can depend on the same personality trait (<span class="math inline">\(\theta_1 = \theta_2 = \theta\)</span>) or different personality traits (<span class="math inline">\(\theta_1 \neq \theta_2\)</span>). Given two statements (<span class="math inline">\(s_1\)</span> and <span class="math inline">\(s_2\)</span>) which depend on one-to-two traits (<span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_2\)</span>) and a probability model of agreeing to either statement on its own (<span class="math inline">\(P_{s_1}\)</span> and <span class="math inline">\(P_{s_2}\)</span>, which have similar functional forms with different item parameters), the probability of choosing statement one over statement two can be modeled by the following item response function:</p>
<p><span class="math display">\[
\begin{align}
P_{\text{mupp}}(s_1 &gt; s_2)  &amp;= P(s_1 &gt; s_2 | \theta_{d_{s_1}}, \theta_{d_{s_2}})\\
                            &amp;\approx \frac{P(X = 1|\theta_{d_{s_1}})P(X = 0|\theta_{d_{s_2}})}
                                          {P(X = 1|\theta_{d_{s_1}})P(X = 0|\theta_{d_{s_2}}) +
                                           P(X = 0|\theta_{d_{s_1}})P(X = 1|\theta_{d_{s_2}})}
\end{align}
\]</span></p>
<p>A few caveats and properties of the above probability function are as follows:</p>
<ol style="list-style-type: decimal">
<li>Typically <span class="math inline">\(P(X = 1|\theta_{d_{s_1}})\)</span> is modeled using the GGUM IRF (because the GGUM model is more plausable for modeling the likelihood of responding to probability statements). In principle, any model of a single trait can be used in place of the GGUM model. Any derivations would only need to be updated with the IRF and IRF derivatives of the chosen model.</li>
<li>The first-to-second line of the above equation depends on the assumption that people independently evaluate personality statements before determining whether to choose one or the other. This assumption might or might not be plausable, and one would have to check model fit of the MUPP model against other plausable IRT models.</li>
<li>The independence assumption allows us to pick-and-choose statements to include in a comparison. Because probabilities can be entered into the above equation without affecting other marginal probabilities, any statement can be compared to any other statement, even if the pairs of comparisons were different during item parameter estimation.</li>
<li>Because of the previous line, this type of model would work well in computerized adaptive testing, where pairs of statements can be chosen that provide the best information given a persons current ability vector estimate.</li>
</ol>
<p>The following plot displays the IRF of several one-dimensional probability functions (with individual statements based on the GGUM model).</p>
<p><img src="mupp-derivatives_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Based on the above graphic, note that in the one-dimensional case, any person is most likely to prefer a statement with <span class="math inline">\(\delta\)</span> closest to <span class="math inline">\(\theta\)</span> regardless of whether or not <span class="math inline">\(\theta &gt; \delta\)</span> or <span class="math inline">\(\theta &lt; \delta\)</span>. These probabilities obviously can change if <span class="math inline">\(\alpha_1 \neq \alpha_2\)</span> or <span class="math inline">\(\tau_1 \neq \tau_2\)</span>, but the general functional form of the IRF is the same. Moreover, if two statements have the same <span class="math inline">\(\delta\)</span>, then the probability is a constant for all <span class="math inline">\(\theta\)</span>. Note that “constant probability” does not mean “.5 probability”. If <span class="math inline">\(\tau_1 &gt; \tau_2\)</span>, then statement 1 is always (probabilistically) prefered to statement 2, so in that case, the IRFs above would be uniformly higher.</p>
</div>
<div id="model-derivatives-1" class="section level3">
<h3 class="hasAnchor">
<a href="#model-derivatives-1" class="anchor"></a>Model Derivatives</h3>
<p>To determine the derivative of the MUPP model (with respect to <span class="math inline">\(\theta\)</span>), define the following expressions:</p>
<p><span class="math display">\[
\begin{align}
A &amp;= P(X = 1|\theta_{d_{s_1}})  &amp; A'  &amp;= \frac{dP(X = 1|\theta_{d_{s_1}})}{d\theta} &amp; A'' &amp;= \frac{d^2P(X = 1|\theta_{d_{s_1}})}{d\theta^2}\\
B &amp;= P(X = 0|\theta_{d_{s_2}})  &amp; B'  &amp;= \frac{dP(X = 0|\theta_{d_{s_2}})}{d\theta} &amp; B'' &amp;= \frac{d^2P(X = 0|\theta_{d_{s_2}})}{d\theta^2}\\
C &amp;= 1 - A                      &amp; C'  &amp;= \frac{dC}{d\theta} = -A'\\
D &amp;= 1 - B                      &amp; D'  &amp;= \frac{dD}{d\theta} = -B'\\
\end{align}
\]</span></p>
<p>Then the MUPP IRF can be re-defined as follows:</p>
<p><span class="math display">\[
P_{\text{mupp}} = \frac{AB}{AB + CD}
\]</span></p>
<p>For the rest of the derivation, assume <span class="math inline">\(\theta_1 \neq \theta_2\)</span>. If <span class="math inline">\(\theta_1 = \theta_2\)</span>, then the derivative is simply the sum of all gradient elements, and the second derivative is simply the sum of all hessian elements.</p>
<p>Using the division rule, the derivative of <span class="math inline">\(P_{\text{mupp}}\)</span> with respect to <span class="math inline">\(\theta_1\)</span> is as follows <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</p>
<p><span class="math display">\[
\begin{align}
\frac{dP_{\text{mupp}}}{d\theta_1}  &amp;= \frac{d\left(\frac{AB}{AB + CD}\right)}{d\theta_1}\\
                                    &amp;= \frac{(AB + CD)(AB)' - (AB)(AB + CD)'}{(AB + CD)^2}\\
                                    &amp;= \frac{(AB + CD)(A'B) - (AB)(A'B + C'D)}{(AB + CD)^2}\\
                                    &amp;= \frac{AA'B^2 + A'BCD - AA'B^2 - ABC'D}{(AB + CD)^2}\\
                                    &amp;= \frac{BD(A'C - AC')}{(AB + CD)^2}\\
                                    &amp;= \frac{BD[A'(1 - A) - A(-A')]}{(AB + CD)^2}\\
                                    &amp;= \frac{BDA'}{(AB + CD)^2}
\end{align}
\]</span></p>
<p>Note that the derivative of <span class="math inline">\(P_{\text{mupp}}\)</span> with respect to <span class="math inline">\(\theta_2\)</span> is clearly:</p>
<p><span class="math display">\[
\frac{dP_{\text{mupp}}}{d\theta_2} = \frac{ACB'}{(AB + CD)^2}
\]</span></p>
<p>The second derivative is a hessian matrix with four elements:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\frac{d^2P_{\text{mupp}}}{d\theta_1^2}\)</span></li>
<li><span class="math inline">\(\frac{d^2P_{\text{mupp}}}{d\theta_2^2}\)</span></li>
<li><span class="math inline">\(\frac{d^2P_{\text{mupp}}}{d\theta_1\theta_2}\)</span></li>
<li><span class="math inline">\(\frac{d^2P_{\text{mupp}}}{d\theta_2\theta_1}\)</span></li>
</ol>
<p>Note that the third and fourth elements are the same because, in this case:</p>
<p><span class="math display">\[
\frac{d^2P_{\text{mupp}}}{d\theta_1\theta_2} = \frac{d^2P_{\text{mupp}}}{d\theta_2\theta_1}
\]</span></p>
<p>Moreover, the first and second elements are found using an identical process with <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> swapped, <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> swapped, and all of the derivatives/second derivatives of the GGUM model also swapped. Therefore, we only really have two derivations.</p>
<p>The diagonal of the hessian matrix can be constructed as follows:</p>
<p><span class="math display">\[
\begin{align}
\frac{d^2P_{\text{mupp}}}{d\theta_1^2}  &amp;= \frac{d\left(\frac{BDA'}{(AB + CD)^2}\right)}{d\theta_1}\\
                                        &amp;= \frac{(AB + CD)^2(BDA')' - (BDA')[(AB + CD)^2]'}{(AB + CD)^4}\\
                                        &amp;= \frac{(AB + CD)^2(BDA'') - (BDA')[2(AB + CD)(A'B + C'D)]}{(AB + CD)^4}\\
                                        &amp;= \frac{(AB + CD)[(AB + CD)(BDA'') - 2(A'B + C'D)(BDA')]}{(AB + CD)^4}\\
                                        &amp;= \frac{BD[A''(AB + CD) - 2A'(A'B + C'D)]}{(AB + CD)^3}\\
                                        &amp;= \frac{BD[A''(AB + CD) - 2A'(A'B - A'(1 - B))]}{(AB + CD)^3}\\
                                        &amp;= \frac{BD[A''(AB + CD) - 2(A')^2(2B - 1)]}{(AB + CD)^3}
\end{align}
\]</span></p>
<p>Note that the second derivative of <span class="math inline">\(P_{\text{mupp}}\)</span> with respect to <span class="math inline">\(\theta_2\)</span> is clearly:</p>
<p><span class="math display">\[
\frac{d^2P_{\text{mupp}}}{d\theta_2^2} = \frac{AC[B''(AB + CD) - 2(B')^2(2A - 1)]}{(AB + CD)^3}
\]</span></p>
<p>Finally, the off-diagonals of the Hessian matrix are as follows:</p>
<p><span class="math display">\[
\begin{align}
\frac{d^2P_{\text{mupp}}}{d\theta_1\theta_2}  &amp;= \frac{d\left(\frac{BDA'}{(AB + CD)^2}\right)}{d\theta_2}\\
                                              &amp;= \frac{(AB + CD)^2\left(\frac{d(BDA')}{d\theta_2}\right) - (BDA')\left(\frac{d(AB + CD)^2}{d\theta_2}\right)}{(AB + CD)^4}\\
                                              &amp;= \frac{(AB + CD)^2\left(\frac{d(A'[B - B^2]}{d\theta_2}\right) - (BDA')\left(\frac{d(AB + CD)^2}{d\theta_2}\right)}{(AB + CD)^4}\\
                                              &amp;= \frac{(AB + CD)^2A'(B' - 2BB') - (BDA')[2(AB + CD)(AB' + CD')]}{(AB + CD)^4}\\
                                              &amp;= \frac{(AB + CD)[(AB + CD)[A'B'(1 - 2B)] - 2A'BD[B'(2A - 1)]}{(AB + CD)^4}\\
                                              &amp;= \frac{(AB + CD)[A'B'(1 - 2B)] - 2A'BD[B'(2A - 1)]}{(AB + CD)^3}\\
                                              &amp;= \frac{A'B'[(AB + CD)(1 - 2B) - 2BD(2A - 1)]}{(AB + CD)^3}\\
                                              &amp;= \frac{A'B'[AB + CD - 2AB^2 - 2BCD - 4ABD + 2BD]}{(AB + CD)^3}\\
                                              &amp;= \frac{A'B'[AB + 1 - A - B + AB - 2AB^2 - 2B(1 - A - B + AB) - 4AB(1 - B) + 2B(1 - B)]}{(AB + CD)^3}\\
                                              &amp;= \frac{A'B'[AB + 1 - A - B + AB - 2AB^2 - 2B + 2AB + 2B^2 - 2AB^2 - 4AB + 4AB^2 + 2B - 2B^2]}{(AB + CD)^3}
\end{align}
\]</span></p>
<p>Rearranging the terms in the numerator of the last statement, we can see that most of them cancel, and we have:</p>
<p><span class="math display">\[
\begin{align}
\frac{d^2P_{\text{mupp}}}{d\theta_1\theta_2}  &amp;= \frac{A'B'[(1 - A - B) + (4AB + 2B + 2B^2 + 4AB^2) - (4AB + 2B + 2B^2 + 4AB^2)]}{(AB + CD)^3}\\
                                              &amp;= \frac{A'B'(1 - A - B)}{(AB + CD)^3}
\end{align}
\]</span></p>
<p>Therefore, if statement 1 is preferred to statement 2, the gradient vector is:</p>
<p><span class="math display">\[
\boldsymbol{g}(P_{\text{mupp}}) =
\frac{dP_{\text{mupp}}}{d\boldsymbol{\theta}} =
\begin{bmatrix}
\frac{BDA'}{(AB + CD)^2}\\
\frac{ACB'}{(AB + CD)^2}
\end{bmatrix}
\]</span></p>
<p>and the hessian matrix is:</p>
<p><span class="math display">\[
\boldsymbol{H}(P_{\text{mupp}}) =
\frac{dP_{\text{mupp}}}{d\boldsymbol{\theta}\boldsymbol{\theta^T}} =
\begin{bmatrix}
\frac{BD[A''(AB + CD) - 2(A')^2(2B - 1)]}{(AB + CD)^3} &amp; \frac{A'B'(1 - A - B)}{(AB + CD)^3}\\
\frac{A'B'(1 - A - B)}{(AB + CD)^3}                    &amp;\frac{AC[B''(AB + CD) - 2(B')^2(2A - 1)]}{(AB + CD)^3}
\end{bmatrix}
\]</span></p>
</div>
<div id="model-extensions" class="section level3">
<h3 class="hasAnchor">
<a href="#model-extensions" class="anchor"></a>Model Extensions</h3>
<p>The MUPP model can be extended to the case of comparing more than two statements. The most common extension of the MUPP model (for this case) is called the MUPP-Rank model (Lee, 2016). In the MUPP-Rank model, the probability of ranking statements <span class="math inline">\(1, 2, 3, \dots\)</span> in a given order determined by <span class="math inline">\(s_1, s_2, s_3, \dots\)</span> is simply</p>
<p><span class="math display">\[
\begin{align}
P_{\text{mupp-rank}}(s_1 &gt; s_2 &gt; s_3 &gt; \dots)
    &amp;= P(s_1 &gt; [s_2, s_3, \dots] \, | \, \theta_{d_{s_1}}, \theta_{d_{s_2}}, \theta_{d_{s_3}}, \dots)\times
       P(s_2 &gt; [s_3, \dots] \, | \, \theta_{d_{s_2}}, \theta_{d_{s_3}}, \dots) \times
       \dots\\
    &amp;=\prod_{k = 1}^{K} P(s_k &gt; [s_{k + 1}, s_{k + 2}, \dots, s_{K}] \, | \, \theta_{d_{s_k}}, \theta_{d_{s_{k + 1}}}, \dots, \theta_{d_{s_K}})
\end{align}
\]</span></p>
<p>In the above equation, the individual probability statements are an extension of the MUPP (choosing 1 statement over all of the others) for more than two statements, assuming independence. In that case, the numerator is simply the product of choosing a statement and not choosing the others (using the products of the probabilities), and the denominator is the sum of the probabilities of choosing any given statement over the others. If <span class="math inline">\(K = 3\)</span>, then the numerator is a single element (e.g., choose statement 1 rather than 2 or 3) and the denominator is three elements (choose statement 1 rather than 2 or 3, choose statement 2 rather than 1 or 3, and choose statement 3 rather than 1 or 2). In this case, there are <span class="math inline">\(3! = 6\)</span> possible rankings of statements. If <span class="math inline">\(K = 4\)</span>, there would be <span class="math inline">\(4! = 24\)</span> possible rankings of statements. In each case, there would be <span class="math inline">\(K!\)</span> item response functions. The derivative and second derivative of the MUPP-Rank model would be theoretically simple but difficult to derive for the general case or efficiently code for all but the simplest of problems. See Lee (2016) for derivations in the <span class="math inline">\(K = 3\)</span> case.</p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li>de la Torre, J., Stark, S., &amp; Chernyshenko, O. S. (2006). Markov Chain Monte Carlo estimation of item parameters for the generalized graded unfolding model. <em>Applied Psychological Measurement</em>, <em>30</em>, 216-232.</li>
<li>Lee (2016). <em>Investigating parameter recovery and item information for triplet multidimensional forced choice measure: An application of the GGUM-RANK model</em> (Doctoral dissertation). Retried from <a href="http://scholarcommons.usf.edu/etd/6928" class="uri">http://scholarcommons.usf.edu/etd/6928</a>
</li>
<li>Stark, S., Chernyshenko, O. S., &amp; Drasgow, F. (2005). An IRT approach to constructing and scoring pairwise preference items involving stimuli on different dimensions. The multi-unidimensional pairwise-preference model. <em>Applied Psychological Measurement</em>, <em>29</em>, 184-203.</li>
</ul>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>The GGUM model is technically a polytomous model with (possibly) more than two response options and “probability” referring to the probability of marking any one of the options. For the remainder of this document, we are considering the GGUM with only two response options: assent to statement or do not assent to statement.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The remaining formulas use prime notation (<span class="math inline">\(A'\)</span>) for the derivative rather than Leibniz’s notation (<span class="math inline">\(\frac{dA}{d\theta}\)</span>). Using prime notation simplifies the appearance of the derivation. Leibniz’s notation is used when prime notation would be ambiguous.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Steven Nydick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
